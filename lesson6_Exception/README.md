## Exception Entry
1)Set the pending bit.  
2)Stacking and Vector fetch.  
3)Entry in handler mode and set active bit.  
4)Clears the pending status(processor does it automatically).  
5)Processor mode changed to handler mode.  
6)Hanlder code start executing.  
7)MSP used for any stack operations inside handler.

---

## Exit Sequence
1)In cortex processor the exception return mechanism is triggered using special return address called EXC_RETURN.  
2)EXC_RETURN generated during entry and stored in LR(Link Register).
3)When EXC_RETURN is written to PC it triggers the exception return.  
4)During exception handler entry,value of the return address is not stored in LR as it is done during calling C function.Instead exception mechanism stores 
special value called EXC_RETURN in LR.

---

## Decoding EXC_RETURN value
1)Bit 2 and 3 used as return stack and return mode respectively.  
For bit 3 thread mode will be represented as 1 and handler mode as 0.  
For bit 2 return will be done with PSP with 1 as bit value and 0 as return with MSP.  
2)What happens when exception triggers:-  
If 2nd bit is 0 unstacking will be done by MSP.MSP selected control[1]=0 and then resume program execution.  
If 2nd bit is 1 unstacking will be done by PSP.PSP selected control[1]=1 and then resume program execution.  

---

## Fault Handlers
Fault exception generated by processor to indicate error.  
Reasons of fault:-  
1)Because of programmers handling processor by violating design rules or due to interfaces with which processor deals.  
2)When fault happens internel processor register will be updated to record type of fault,the address of instruction at which fault happened and if an
associated exception is enabled exception handler will be called by processor.  
3)In exception hanlder programmers may implement code to report,resolve or recover from fault.For example divide by 0.  
4)Reset,NMI,HardFault are such type of exceptions which are nonconfigurable.They are fixed in priority.  
5)Fault exceptions include hard fault,MemManage fault,BusFault,Usage Fault.  
6)Hard fault exceptions can be disabled using fault mask register.

---

## Real problems of fault
1)Divide by zero and undefined instructions.  
2)Attempt to execute code from memory region which is marked as execute never to prevent code injection.  
3)MPU guarded memory region access violation by code and unaligned data access.  
4)Returning to thread made keeping active interrupt alive and bus error.  
5)Executing SVC instruction inside SVC handler or calling function in SVC handler which eventually execute hidden SVC instruction.  
6)Debug monitor settings and related exceptions.

---

## Hard Fault Execption
Occurs because of an error during exception processing or exception not handled by other mechanism.  
Causes:-  
1)Escalation of configurable fault exceptions.  
2)Bus error returned during vector fetch.  
3)Execution of break point instruction when both halt mode and debug monitor is disabled.  
4)Executing SVC instruction inside SVC handler.  
5)When any configurable exceptions not enabled they are escalated to hardfault.

---

## MemManage Fault Exception
1)Configurable fault exception disabled by default.  
2)Can enable this exception by configuring processor register "System Handler Control and State Register".
3)Priority also configurable.  

Causes:-
1)Detected when memory access violation detected.Unprivileged thread mode code tries to access memory region which is privileged access only.  
2)Writing to memory which is read only.It is triggered only when we execute code from peripheral memory region.Peripheral memory region are execute never region.  
Execute Never regions:-  
Peripheral,Externel RAM,Externel device,PPB,etc.

---

## Bus Fault
Causes:-  
1)Due to error response returned by processor bus interfaces during access to memory devices during fetch and data read/write.  
2)If bus error happens during vector fetch it will be escalated to hard fault even if bus fault exception is enabled.  
3)Memory device sends error response when processor bus interface tries to access invalid or restricted memory locations which could generate bus fault.  
4)Whne device is not ready to accept memory transfer.  
5)Encountered with this when play with external memories such as SDRAM connected via DRAM controllers.  
6)Unprivileged access to PPB.

---

## Usage Fault
Causes:-  
1)Execution of undefined instructions.For example ARM ISA not supported and if executed.  
2)Without FPU execute floating instruction and if we kept T bit 0.  
3)Return to thread mode when still executing exception.  
4)Unaligned memory access with multiple load and store instructions.  
5)Divided by zero and unaligned data access from memory.

---

